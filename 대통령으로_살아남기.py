import streamlit as st
import pandas as pd
import random
import base64
import os
from datetime import datetime

# =============================================================================
# [1] ê¸°ë³¸ ì„¤ì •
# =============================================================================
st.set_page_config(page_title="ëŒ€í†µë ¹ìœ¼ë¡œ ì‚´ì•„ë‚¨ê¸°", layout="centered")

FILE_BGM = "bgm.mp3"
FILE_BG = "background.jpg"
FILE_EMBLEM = "emblem.jpg"
FILE_RANKING = "ranking.csv"

ARCHS = ["ìë³¸ê°€", "ì¤‘ì‚°ì¸µ", "ë…¸ë™ì", "ë¹ˆê³¤ì¸µ"]

# =============================================================================
# [2] í•µì‹¬ ê¸°ëŠ¥ í•¨ìˆ˜
# =============================================================================

def get_base64_file(bin_file):
    if os.path.exists(bin_file):
        try:
            with open(bin_file, 'rb') as f:
                data = f.read()
            return base64.b64encode(data).decode()
        except:
            return None
    return None

def render_bgm():
    b64 = get_base64_file(FILE_BGM)
    if b64:
        st.markdown(f"""
            <div style="margin-bottom: 10px; padding: 10px; background: rgba(0,0,0,0.5); border-radius: 10px;">
                <p style="color:gold; font-weight:bold; margin:0; font-size:0.8rem;">ğŸµ BGM Playing</p>
                <audio controls autoplay loop style="width:100%; height:30px;">
                    <source src="data:audio/mp3;base64,{b64}" type="audio/mp3">
                </audio>
            </div>
        """, unsafe_allow_html=True)

def render_background():
    b64 = get_base64_file(FILE_BG)
    if b64:
        st.markdown(
            f'<img src="data:image/jpeg;base64,{b64}" style="width:100%; border-radius:10px; margin-bottom:20px; box-shadow: 0 4px 15px rgba(0,0,0,0.5);">',
            unsafe_allow_html=True
        )

def get_emblem_tag():
    return '<div style="font-size: 80px; text-align:center; margin-bottom: 10px;">ğŸ‡°ğŸ‡·</div>'

def update_name():
    st.session_state.player_name = st.session_state.temp_name

def get_crisis_image(idx, default_url):
    local_filename = f"crisis_{idx}.jpg"
    if os.path.exists(local_filename):
        return local_filename
    return default_url

# [ì¶”ê°€] ì •ì¹˜ì¸ ì´ë¯¸ì§€ ë¡œë” (íŒŒì¼ ìš°ì„  -> ì›¹ URL)
# íŒŒì¼ëª… ê·œì¹™: poly_ì•„ì´ë””.jpg (ì˜ˆ: poly_roh.jpg)
def get_model_image(model_id, default_url):
    local_filename = f"poly_{model_id}.jpg"
    if os.path.exists(local_filename):
        return local_filename
    return default_url

# [ë­í‚¹ ì‹œìŠ¤í…œ]
def load_ranking():
    if not os.path.exists(FILE_RANKING):
        return pd.DataFrame(columns=["ì´ë¦„", "ì ìˆ˜", "ì¹­í˜¸", "ì¼ì‹œ"])
    return pd.read_csv(FILE_RANKING)

def save_ranking(name, score, title):
    df = load_ranking()
    now = datetime.now().strftime("%m-%d %H:%M")
    new_data = pd.DataFrame({"ì´ë¦„": [name], "ì ìˆ˜": [score], "ì¹­í˜¸": [title], "ì¼ì‹œ": [now]})
    df = pd.concat([df, new_data], ignore_index=True)
    df = df.sort_values(by="ì ìˆ˜", ascending=False)
    df.to_csv(FILE_RANKING, index=False)
    return df

# [ì •ì¹˜ ì„±í–¥ ë¶„ì„]
def get_politician_type(stats):
    con_score = stats["ìë³¸ê°€"] + stats["ì¤‘ì‚°ì¸µ"]
    pro_score = stats["ë…¸ë™ì"] + stats["ë¹ˆê³¤ì¸µ"]
    diff = pro_score - con_score
    
    if diff > 30: return "ì§„ë³´"
    elif diff > 0: return "ì¤‘ë„ì§„ë³´"
    elif diff > -30: return "ì¤‘ë„ë³´ìˆ˜"
    else: return "ë³´ìˆ˜"

# =============================================================================
# [3] ê²Œì„ ë°ì´í„° (ìƒì„¸ ë‚´ìš© í¬í•¨)
# =============================================================================

ARCH_DESC = {
    "ìë³¸ê°€": """
    **ğŸ’° [ìë³¸ê°€/ê¸°ì—…ì£¼]**
    - **ì„±í–¥:** ì„¸ê¸ˆ ì¸ìƒê³¼ ê·œì œë¥¼ ê·¹ë„ë¡œ í˜ì˜¤í•˜ë©°, ì‹œì¥ì˜ ììœ ë¥¼ ìµœìš°ì„  ê°€ì¹˜ë¡œ ë‘¡ë‹ˆë‹¤.
    - **ìœ„í˜‘:** ì§€ì§€ìœ¨ì´ ë°”ë‹¥ë‚˜ë©´ ìë³¸ì„ í•´ì™¸ë¡œ ë¹¼ëŒë ¤(Capital Flight) êµ­ê°€ ê²½ì œë¥¼ ë§ˆë¹„ì‹œí‚µë‹ˆë‹¤.
    """,
    "ì¤‘ì‚°ì¸µ": """
    **ğŸ  [í™”ì´íŠ¸ì¹¼ë¼/ìœ ì£¼íƒì]**
    - **ì„±í–¥:** 'ë‚´ ì„¸ê¸ˆì´ ë‚­ë¹„ë˜ëŠ” ê²ƒ'ì„ ê°€ì¥ ì‹«ì–´í•˜ë©° ë¶€ë™ì‚°ê³¼ êµìœ¡, ë¬¼ê°€ì— ë¯¼ê°í•©ë‹ˆë‹¤.
    - **ìœ„í˜‘:** ì§€ì§€ìœ¨ì´ ë°”ë‹¥ë‚˜ë©´ ëŒ€ê·œëª¨ ì¡°ì„¸ ì €í•­ ìš´ë™ê³¼ ì •ê¶Œ í‡´ì§„ ì‹œìœ„ë¥¼ ì£¼ë„í•©ë‹ˆë‹¤.
    """,
    "ë…¸ë™ì": """
    **ğŸ‘· [ë¸”ë£¨ì¹¼ë¼/ì„ê¸ˆìƒí™œì]**
    - **ì„±í–¥:** ê³ ìš© ì•ˆì •ê³¼ ì„ê¸ˆ ì¸ìƒì´ ìƒì¡´ê³¼ ì§ê²°ë©ë‹ˆë‹¤. ì‰¬ìš´ í•´ê³ ë¥¼ ë‘ë ¤ì›Œí•©ë‹ˆë‹¤.
    - **ìœ„í˜‘:** ì§€ì§€ìœ¨ì´ ë°”ë‹¥ë‚˜ë©´ êµ­ê°€ ê¸°ë°˜ ì‹œì„¤(ì² ë„, ì „ë ¥)ì„ ë©ˆì¶”ëŠ” ì´íŒŒì—…ì„ ì¼ìœ¼í‚µë‹ˆë‹¤.
    """,
    "ë¹ˆê³¤ì¸µ": """
    **ğŸ™ [ê¸°ì´ˆìˆ˜ê¸‰/ì†Œì™¸ê³„ì¸µ]**
    - **ì„±í–¥:** ì •ë¶€ì˜ ë³µì§€ ì§€ì› ì—†ì´ëŠ” ìƒì¡´ì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤. ê³µê³µ ì„œë¹„ìŠ¤ì— ì „ì ìœ¼ë¡œ ì˜ì¡´í•©ë‹ˆë‹¤.
    - **ìœ„í˜‘:** ì§€ì§€ìœ¨ì´ ë°”ë‹¥ë‚˜ë©´ ìƒì¡´ì„ ìœ„í•´ ê±°ë¦¬ë¡œ ë›°ì³ë‚˜ì™€ ê±·ì¡ì„ ìˆ˜ ì—†ëŠ” í­ë™ì„ ì¼ìœ¼í‚µë‹ˆë‹¤.
    """
}

# [ìˆ˜ì •] ì •ì¹˜ì¸ ë°ì´í„° (ID ì¶”ê°€ë¨)
POLITICIAN_TYPES = {
    "ì§„ë³´": {
        "title": "ì„œë¯¼ì˜ ë²—, í–‰ë™í•˜ëŠ” ì–‘ì‹¬",
        "desc": "ë‹¹ì‹ ì€ ì„œë¯¼ê³¼ ë…¸ë™ìë¥¼ ìœ„í•œ ì •ì±…ì„ ê³¼ê°í•˜ê²Œ í¼ì³¤ìŠµë‹ˆë‹¤. ê¸°ë“ê¶Œê³¼ì˜ íƒ€í˜‘ë³´ë‹¤ëŠ” ì›ì¹™ì„ ì¤‘ìš”ì‹œí•˜ë©°, ëŒ€ì¤‘ì˜ ëœ¨ê±°ìš´ ì§€ì§€ë¥¼ ë°›ì•˜ìŠµë‹ˆë‹¤.",
        "models": [
            {"name": "ë…¸ë¬´í˜„", "id": "roh", "img": "https://upload.wikimedia.org/wikipedia/commons/f/f3/Roh_Moo-hyun_Presidential_Portrait.jpg"},
            {"name": "ê¹€ëŒ€ì¤‘", "id": "dj", "img": "https://upload.wikimedia.org/wikipedia/commons/e/ee/Kim_Dae-jung_Official_Portrait.jpg"}
        ]
    },
    "ì¤‘ë„ì§„ë³´": {
        "title": "ì›ì¹™ê³¼ í¬ìš©ì˜ ë¦¬ë”ì‹­",
        "desc": "ë‹¹ì‹ ì€ ê°œí˜ì„ ì¶”êµ¬í•˜ë©´ì„œë„ ì•ˆì •ì ì¸ êµ­ì • ìš´ì˜ì„ ì‹œë„í–ˆìŠµë‹ˆë‹¤. ë³µì§€ì™€ ê³µì •ì„±ì„ ê°•ì¡°í•˜ë©° íƒ„íƒ„í•œ ì§€ì§€ì¸µì„ í™•ë³´í–ˆìŠµë‹ˆë‹¤.",
        "models": [
            {"name": "ë¬¸ì¬ì¸", "id": "moon", "img": "https://upload.wikimedia.org/wikipedia/commons/3/36/Moon_Jae-in_presidential_portrait.jpg"},
            {"name": "ì´ì¬ëª…", "id": "lee", "img": "https://upload.wikimedia.org/wikipedia/commons/thumb/6/6c/Lee_Jae-myung_%28cropped%29.jpg/440px-Lee_Jae-myung_%28cropped%29.jpg"}
        ]
    },
    "ì¤‘ë„ë³´ìˆ˜": {
        "title": "ì‹¤ìš©ì£¼ì˜ì™€ í˜ì‹ ",
        "desc": "ë‹¹ì‹ ì€ ì´ë…ë³´ë‹¤ëŠ” ì‹¤ìš©ê³¼ ê³¼í•™, í•©ë¦¬ì„±ì„ ì¤‘ì‹œí–ˆìŠµë‹ˆë‹¤. ê¸°ì¡´ ì •ì¹˜ ë¬¸ë²•ì„ ê¹¨ëŠ” ìƒˆë¡œìš´ ì‹œë„ë¡œ ì¤‘ë„ì¸µì˜ í˜¸ì‘ì„ ì–»ì—ˆìŠµë‹ˆë‹¤.",
        "models": [
            {"name": "ì•ˆì² ìˆ˜", "id": "ahn", "img": "https://upload.wikimedia.org/wikipedia/commons/thumb/c/cd/Ahn_Cheol-soo_portrait.jpg/440px-Ahn_Cheol-soo_portrait.jpg"},
            {"name": "ì´ì¤€ì„", "id": "jun", "img": "https://upload.wikimedia.org/wikipedia/commons/thumb/5/5a/Lee_Jun-seok_%28cropped%29.jpg/440px-Lee_Jun-seok_%28cropped%29.jpg"}
        ]
    },
    "ë³´ìˆ˜": {
        "title": "ììœ  ì‹œì¥ê³¼ ë²•ì¹˜",
        "desc": "ë‹¹ì‹ ì€ ì‹œì¥ì˜ ììœ ì™€ íŠ¼íŠ¼í•œ ì•ˆë³´ë¥¼ ìµœìš°ì„ ìœ¼ë¡œ ì—¬ê²¼ìŠµë‹ˆë‹¤. ê¸°ì—…í•˜ê¸° ì¢‹ì€ ë‚˜ë¼ë¥¼ ë§Œë“¤ê³  ë²•ê³¼ ì›ì¹™ì„ ê°•ì¡°í–ˆìŠµë‹ˆë‹¤.",
        "models": [
            {"name": "ìœ¤ì„ì—´", "id": "yoon", "img": "https://upload.wikimedia.org/wikipedia/commons/thumb/7/74/Yoon_Suk-yeol_in_May_2022.jpg/440px-Yoon_Suk-yeol_in_May_2022.jpg"},
            {"name": "ê¹€ë¬¸ìˆ˜", "id": "kim", "img": "https://upload.wikimedia.org/wikipedia/commons/thumb/a/a2/Kim_Moon-soo_in_October_2024.png/440px-Kim_Moon-soo_in_October_2024.png"}
        ]
    }
}

CRISES_POOL = {
    "ì´ˆê¸°": [
        {"id": 13, "title": "ğŸ” í”„ëœì°¨ì´ì¦ˆ ê°‘ì§ˆ íŒŒë™", "img": "https://images.unsplash.com/photo-1550547660-d9450f859349", "desc": "ëŒ€í˜• ë³¸ì‚¬ì˜ ê°‘ì§ˆë¡œ ê°€ë§¹ì ì£¼ê°€ ì‚¬ë§í•˜ëŠ” ë¹„ê·¹ì´ ë°œìƒí–ˆìŠµë‹ˆë‹¤. 'ì„ì˜ ëˆˆë¬¼'ì— ê³µê°í•œ êµ­ë¯¼ë“¤ì˜ ë¶„ë…¸ê°€ ë“¤ë“ê³  ìˆìœ¼ë©°, ê°•ë ¥í•œ ê²½ì œ ë¯¼ì£¼í™”ë¥¼ ìš”êµ¬í•˜ëŠ” ëª©ì†Œë¦¬ê°€ ë†’ìŠµë‹ˆë‹¤.", "options": [{"name": "ê·œì œ 3ë²• í†µê³¼", "cost": 0, "effect": [-20, 5, 10, 10], "detail": "ëŒ€ê¸°ì—…ì˜ íš¡í¬ë¥¼ ë§‰ì„ ê°•ë ¥í•œ ë²•ì•ˆì„ ë§Œë“­ë‹ˆë‹¤. ì„(ä¹™)ë“¤ì€ í™˜í˜¸í•˜ì§€ë§Œ, ì¬ê³„ëŠ” 'ê¸°ì—… ì£½ì´ê¸°'ë¼ë©° íˆ¬ì ì¶•ì†Œë¥¼ ê²½ê³ í•©ë‹ˆë‹¤.", "reason": "ìë³¸ê°€-20 (ê·œì œ), ë…¸ë™ì+10 (ë³´í˜¸)"}, {"name": "ììœ¨ ìƒìƒ ìœ ë„", "cost": 0, "effect": [10, -5, -10, -5], "detail": "ê¸°ì—…ì˜ ìì •ì— ë§¡ê¸°ê¸°ë¡œ í–ˆìŠµë‹ˆë‹¤. ì‹œì¥ ììœ ëŠ” ì§€ì¼°ìœ¼ë‚˜, êµ­ë¯¼ë“¤ì€ 'ê¸°ì—… ë´ì£¼ê¸°'ë¼ë©° ì •ë¶€ê°€ ë¡œë¹„ì— ë„˜ì–´ê°”ë‹¤ê³  ì˜ì‹¬í•©ë‹ˆë‹¤.", "reason": "ìë³¸ê°€+10 (ììœ ), ë…¸ë™ì-10 (ì‹¤ë§)"}, {"name": "ê¸´ê¸‰ ëŒ€ì¶œ ì§€ì›", "cost": -15, "effect": [-5, 5, 0, 10], "detail": "í”¼í•´ ì…ì€ ìì˜ì—…ìì—ê²Œ ëˆì„ ë¹Œë ¤ì¤ë‹ˆë‹¤. ë‹¹ì¥ íì—…ì€ ë§‰ì•˜ì§€ë§Œ ê·¼ë³¸ì ì¸ êµ¬ì¡°ëŠ” ê·¸ëŒ€ë¡œì´ë©°, ê°€ê³„ ë¶€ì±„ë§Œ ëŠ˜ë¦¬ëŠ” ê¼´ì´ ë˜ì—ˆìŠµë‹ˆë‹¤.", "reason": "ë¹ˆê³¤ì¸µ+10 (ìƒì¡´), êµ­ê³ -15 (ì§€ì¶œ)"}]},
        {"id": 14, "title": "ğŸ“‰ ì½”ì¸ ê±°ë˜ì†Œ ë¨¹íŠ€", "img": "https://images.unsplash.com/photo-1621504450168-38f647319936", "desc": "êµ­ë‚´ 1ìœ„ ì½”ì¸ ê±°ë˜ì†Œê°€ ë¨¹íŠ€ íŒŒì‚°í–ˆìŠµë‹ˆë‹¤. 2030 ì„¸ëŒ€ì˜ ìì‚°ì´ ì¦ë°œí•˜ê³  ìì‚´ ì‹œë„ê°€ ì‡ë”°ë¥´ë©° ì‚¬íšŒì  í˜¼ë€ì´ ê°€ì¤‘ë˜ê³  ìˆìŠµë‹ˆë‹¤.", "options": [{"name": "íˆ¬ìì ì†ì‹¤ ë³´ì „", "cost": -25, "effect": [-10, -10, 15, -5], "detail": "ì„¸ê¸ˆìœ¼ë¡œ í”¼í•´ë¥¼ ë³´ì „í•´ì¤ë‹ˆë‹¤. ì²­ë…„ íŒŒì‚°ì€ ë§‰ì•˜ìœ¼ë‚˜, 'ë„ë°• ë¹šì„ ê°šì•„ì£¼ëƒ'ëŠ” ì„±ì‹¤ ë‚©ì„¸ìë“¤ì˜ ë¶„ë…¸ê°€ í­ë°œí–ˆìŠµë‹ˆë‹¤.", "reason": "ë…¸ë™ì+15 (êµ¬ì œ), ì¤‘ì‚°ì¸µ-10 (ë¶„ë…¸)"}, {"name": "ì±…ì„ ì›ì¹™", "cost": 0, "effect": [5, 5, -20, -10], "detail": "íˆ¬ê¸° ìˆ˜ìš”ì— ê²½ì¢…ì„ ìš¸ë ¸ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì „ ì¬ì‚°ì„ ìƒì€ ì²­ë…„ì¸µì´ ëŒ€ê±° ì‹ ìš©ë¶ˆëŸ‰ìë¡œ ì „ë½í•˜ë©° ì‚¬íšŒì  í™œë ¥ì´ ê¸‰ê²©íˆ ë–¨ì–´ì§‘ë‹ˆë‹¤.", "reason": "ì¤‘ì‚°ì¸µ+5 (ì›ì¹™), ë…¸ë™ì-20 (íŒŒì‚°)"}, {"name": "ê°€ìƒìì‚° ê·œì œ ê°•í™”", "cost": -5, "effect": [-5, 0, -5, 0], "detail": "ë’¤ëŠ¦ê²Œ ê·œì œ ì¥ë²½ì„ ì„¸ì› ìŠµë‹ˆë‹¤. ì‹œì¥ì€ ê±´ì „í•´ì¡Œì§€ë§Œ, 'ì†Œ ìƒê³  ì™¸ì–‘ê°„ ê³ ì¹˜ê¸°'ë¼ëŠ” ë¹„íŒê³¼ í•¨ê»˜ ë¸”ë¡ì²´ì¸ ì‚°ì—… ìœ„ì¶•ì„ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤.", "reason": "ìë³¸ê°€-5 (ê·œì œ), ë…¸ë™ì-5 (ë’·ë¶)"}]},
        {"id": 3, "title": "ğŸ¤– AI ì¼ìë¦¬ ìŠµê²©", "img": "https://images.unsplash.com/photo-1485827404703-89b55fcc595e", "desc": "ìƒì„±í˜• AIì˜ ë°œì „ìœ¼ë¡œ ì‚¬ë¬´ì§ê³¼ ë‹¨ìˆœ ë…¸ë¬´ì§ì˜ ëŒ€ëŸ‰ í•´ê³ ê°€ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤. 'ê¸°ê³„ê°€ ì¸ê°„ì„ ëŒ€ì²´í•œë‹¤'ëŠ” ê³µí¬ê°€ ì‚¬íšŒë¥¼ ë®ì³¤ìŠµë‹ˆë‹¤.", "options": [{"name": "ë¡œë´‡ì„¸ ë„ì… (ê¸°ë³¸ì†Œë“)", "cost": -15, "effect": [-20, 5, 10, 10], "detail": "ê¸°ì—…ì— ì„¸ê¸ˆì„ ë¬¼ë ¤ ì‹¤ì§ìì—ê²Œ í˜„ê¸ˆì„ ì§€ê¸‰í•©ë‹ˆë‹¤. ë…¸ë™ìë“¤ì€ ì•ˆë„í•˜ì§€ë§Œ, ê¸°ì—…ë“¤ì€ 'í˜ì‹ ì„ ê°€ë¡œë§‰ëŠ” ê·œì œ ê°ì˜¥'ì´ë¼ë©° ë°˜ë°œí•©ë‹ˆë‹¤.", "reason": "ìë³¸ê°€-20 (ê·œì œ), ë…¸ë™ì+10 (ì•ˆì „ë§)"}, {"name": "AI ê·œì œ ì² í (ì„±ì¥)", "cost": +10, "effect": [20, 5, -15, -15], "detail": "AI ê°•êµ­ìœ¼ë¡œ ë„ì•½í•˜ë©° êµ­ê°€ ê²½ìŸë ¥ì€ í­ë“±í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ êµ¬ì¡°ì¡°ì • ë‹¹í•œ ìˆ˜ë§Œ ëª…ì˜ ë…¸ë™ìë“¤ì´ ê±°ë¦¬ë¡œ ë‚˜ì•‰ì•„ ë¹ˆê³¤ì¸µìœ¼ë¡œ ì „ë½í•©ë‹ˆë‹¤.", "reason": "ìë³¸ê°€+20 (ì£¼ê°€í­ë“±), ë…¸ë™ì-15 (í•´ê³ )"}, {"name": "ê³µê³µ ê·¼ë¡œ í™•ëŒ€", "cost": -20, "effect": [-5, -5, 5, 10], "detail": "ì •ë¶€ê°€ ì„¸ê¸ˆìœ¼ë¡œ ë‹¨ê¸° ì¼ìë¦¬ë¥¼ ê¸‰ì¡°í•´ ê¸‰í•œ ë¶ˆì€ ê»ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ 'ì„¸ê¸ˆ ë‚­ë¹„', 'ì§ˆ ë‚®ì€ ì¼ìë¦¬'ë¼ëŠ” ë¹„íŒì„ ë°›ìŠµë‹ˆë‹¤.", "reason": "ë¹ˆê³¤ì¸µ+10 (ìƒê³„), êµ­ê³ -20 (ë¹„ìš©)"}]},
        {"id": 12, "title": "ğŸ§¬ ì‹ ì•½ ë¶€ì‘ìš© ì‚¬íƒœ", "img": "https://images.unsplash.com/photo-1532187863486-abf9dbad1b69", "desc": "êµ­ê°€ ì§€ì› ì‹ ì•½ì—ì„œ ì¹˜ëª…ì ì¸ ë¶€ì‘ìš©ì´ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤. í”¼í•´ìë“¤ì˜ ì†Œì†¡ê³¼ ì •ë¶€ ì±…ì„ë¡ ì´ ëŒ€ë‘ë˜ë©° ë°”ì´ì˜¤ ì‚°ì—…ì´ í”ë“¤ë¦½ë‹ˆë‹¤.", "options": [{"name": "í—ˆê°€ ì·¨ì†Œ ë° ë°°ìƒ", "cost": -20, "effect": [-10, 5, 5, 5], "detail": "êµ­ë¯¼ ì•ˆì „ì„ ì„ íƒí•´ ì‹ ë¢°ë¥¼ íšŒë³µí–ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ë°”ì´ì˜¤ ì‚°ì—… íˆ¬ìê°€ ìœ„ì¶•ë˜ê³ , ê´€ë ¨ ê¸°ì—… ì£¼ê°€ í­ë½ìœ¼ë¡œ ê°œë¯¸ íˆ¬ììë“¤ì´ ìš¸ìƒì…ë‹ˆë‹¤.", "reason": "ì¤‘ì‚°ì¸µ+5 (ì‹ ë¢°), ìë³¸ê°€-10 (ì£¼ê°€í•˜ë½)"}, {"name": "ì¸ê³¼ê´€ê³„ ê·œëª… ìš°ì„ ", "cost": 0, "effect": [10, -10, -10, -5], "detail": "ì‚°ì—… ë³´í˜¸ë¥¼ ìœ„í•´ ì‹œê°„ì„ ëŒì—ˆìŠµë‹ˆë‹¤. ê¸°ì—…ì€ ì•ˆë„í•˜ì§€ë§Œ, í”¼í•´ìë“¤ì€ 'ê¸°ì—… í¸ë“¤ê¸°'ë¼ë©° ìš¸ë¶„ì„ í† í•˜ê³  ì •ë¶€ì˜ ìƒëª… ê²½ì‹œ í’ì¡°ê°€ ë¹„íŒë°›ìŠµë‹ˆë‹¤.", "reason": "ìë³¸ê°€+10 (ë³´í˜¸), ì¤‘ì‚°ì¸µ-10 (ë¹„íŒ)"}, {"name": "ê³µê³µ ì˜ë£Œ ê°•í™”", "cost": -30, "effect": [-15, 5, 10, 15], "detail": "ë¯¼ê°„ ì£¼ë„ ê°œë°œì˜ í•œê³„ë¥¼ ì¸ì •í•˜ê³  ê³µê³µ ì˜ë£Œë¥¼ í™•ì¶©í–ˆìŠµë‹ˆë‹¤. ì˜ë£Œ ì„œë¹„ìŠ¤ ì§ˆì€ ì˜¬ëìœ¼ë‚˜, ë§‰ëŒ€í•œ ì„¸ê¸ˆì´ íˆ¬ì…ë˜ì–´ ê³ ì†Œë“ì¸µ ì €í•­ì´ ì‹¬í•©ë‹ˆë‹¤.", "reason": "ë¹ˆê³¤ì¸µ+15 (í˜œíƒ), ìë³¸ê°€-15 (ì„¸ê¸ˆ)"}]}
    ],
    "ì¤‘ê¸°": [
        {"id": 7, "title": "ğŸ˜ï¸ ë¶€ë™ì‚° ì‹œì¥ ëŒ€í­ë½", "img": "https://images.unsplash.com/photo-1560518883-ce09059eeffa", "desc": "ê¸ˆë¦¬ ì¸ìƒ ì—¬íŒŒë¡œ ì§‘ê°’ì´ 30% ì´ìƒ ê¸‰ë½í–ˆìŠµë‹ˆë‹¤. ê¹¡í†µ ì „ì„¸ í”¼í•´ìê°€ ì†ì¶œí•˜ê³  ê±´ì„¤ì‚¬ ë¶€ë„ ìœ„ê¸°ê°€ ê°ë•ë‹ˆë‹¤.", "options": [{"name": "ë¶€ì–‘ì±… (ê·œì œ ì™„í™”)", "cost": -10, "effect": [15, 5, -10, -10], "detail": "ë‹¤ì£¼íƒì ê°ì„¸ì™€ ëŒ€ì¶œ ì™„í™”ë¡œ ì§‘ê°’ ë°©ì–´ì— ì„±ê³µí•´ ìì‚°ê°€ë“¤ì€ ì•ˆë„í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ 'ë¶€ìë§Œ ì‚´ë ¤ì¤€ë‹¤'ëŠ” ë¹„íŒ ì†ì— ë¬´ì£¼íƒ ì„œë¯¼ì˜ ê¿ˆì€ ë©€ì–´ì§‘ë‹ˆë‹¤.", "reason": "ìë³¸ê°€+15 (ìì‚°ë°©ì–´), ë…¸ë™ì-10 (ë°•íƒˆê°)"}, {"name": "ì‹œì¥ ììœ¨ (ë°©ê´€)", "cost": 0, "effect": [-20, -20, 10, 5], "detail": "ê±°í’ˆì´ êº¼ì§€ë©° ë¬´ì£¼íƒìë“¤ì€ í™˜í˜¸í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ ìì‚°ì´ ì¦ë°œí•œ ìƒìœ„ì¸µê³¼ ì¤‘ì‚°ì¸µì˜ ì†Œë¹„ê°€ ì–¼ì–´ë¶™ì–´ ì‹¤ë¬¼ ê²½ê¸°ê°€ ê¹Šì€ ì¹¨ì²´ì— ë¹ ì§‘ë‹ˆë‹¤.", "reason": "ìë³¸ê°€-20 (í­ë½), ë…¸ë™ì+10 (ë‚´ì§‘ë§ˆë ¨)"}, {"name": "ì „ì„¸ ì‚¬ê¸° í”¼í•´ êµ¬ì œ", "cost": -20, "effect": [-5, -5, 10, 15], "detail": "ì„¸ê¸ˆìœ¼ë¡œ í”¼í•´ ë³´ì¦ê¸ˆì„ ì§€ì›í•´ ì„œë¯¼ë“¤ì˜ ëˆˆë¬¼ì„ ë‹¦ì•„ì£¼ì—ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì„±ì‹¤ ìƒí™˜ìë“¤ê³¼ì˜ í˜•í‰ì„± ë…¼ë€ì´ ì¼ë©° ë‚©ì„¸ìë“¤ì˜ ë¶ˆë§Œì´ ì»¤ì§‘ë‹ˆë‹¤.", "reason": "ë¹ˆê³¤ì¸µ+15 (êµ¬ì œ), êµ­ê³ -20 (ì„¸ê¸ˆ)"}]},
        {"id": 9, "title": "âš¡ ì—ë„ˆì§€ ìœ„ê¸°", "img": "https://images.unsplash.com/photo-1565514020125-998dc57774dc", "desc": "ì¤‘ë™ ì „ìŸìœ¼ë¡œ ìœ ê°€ê°€ ë°°ëŸ´ë‹¹ 150ë¶ˆì„ ë„˜ì—ˆìŠµë‹ˆë‹¤. ë‚œë°©ë¹„ í­íƒ„ì— ì„œë¯¼ë“¤ì€ ë–¨ê³  ìˆê³ , í•œì „ ì ìëŠ” ê°ë‹¹ ë¶ˆê°€ì…ë‹ˆë‹¤.", "options": [{"name": "ìš”ê¸ˆ í˜„ì‹¤í™” (ì¸ìƒ)", "cost": +10, "effect": [0, -10, -15, -20], "detail": "ê³µê¸°ì—… ë¶€ì‹¤ì€ ë§‰ì•˜ê³  êµ­ê°€ ì‹ ìš©ë„ë„ ì§€ì¼°ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ê´€ë¦¬ë¹„ ê³ ì§€ì„œë¥¼ ë°›ì€ êµ­ë¯¼ë“¤ì˜ ë¶„ë…¸ê°€ í•˜ëŠ˜ì„ ì°Œë¥´ê³ , ì·¨ì•½ê³„ì¸µì€ ëƒ‰ê³¨ì—ì„œ ì¡ë‹ˆë‹¤.", "reason": "êµ­ê³ +10 (ê±´ì „ì„±), ë¹ˆê³¤ì¸µ-20 (ìƒì¡´ìœ„í˜‘)"}, {"name": "ìš”ê¸ˆ ë™ê²° (ì ì ë³´ì „)", "cost": -30, "effect": [-5, 10, 10, 10], "detail": "ì„¸ê¸ˆìœ¼ë¡œ ìš”ê¸ˆ ì¸ìƒì„ ë§‰ì•„ êµ­ë¯¼ ë¶€ë‹´ì€ ì¤„ì˜€ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ êµ­ê°€ ë¶€ì±„ê°€ ê¸‰ì¦í–ˆê³ , ì—ë„ˆì§€ ê³¼ì†Œë¹„ëŠ” ì—¬ì „í•´ ë¯¸ë´‰ì±…ì´ë¼ëŠ” ë¹„íŒì„ ë°›ìŠµë‹ˆë‹¤.", "reason": "ë¹ˆê³¤ì¸µ+10 (ì•ˆë„), êµ­ê³ -30 (ë¶€ì±„)"}, {"name": "ë°”ìš°ì²˜ ì„ ë³„ ì§€ê¸‰", "cost": -10, "effect": [0, -5, -5, 15], "detail": "ì·¨ì•½ê³„ì¸µì—ê²Œë§Œ ë‚œë°©ë¹„ë¥¼ ì§€ì›í–ˆìŠµë‹ˆë‹¤. ì§€ì›ì„ ëª» ë°›ì€ ì¤‘ì‚°ì¸µê³¼ ì„œë¯¼ë“¤ì€ 'ë‚˜ë„ í˜ë“ ë° ì™œ ì•ˆ ì£¼ëƒ'ë©° ìƒëŒ€ì  ë°•íƒˆê°ì„ í˜¸ì†Œí•©ë‹ˆë‹¤.", "reason": "ë¹ˆê³¤ì¸µ+15 (ìƒì¡´), ë…¸ë™ì-5 (ë°•íƒˆê°)"}]},
        {"id": 4, "title": "âš”ï¸ ë¬´ì—­ ë³´ë³µ ì¡°ì¹˜", "img": "https://images.unsplash.com/photo-1595246737293-27d096162332", "desc": "ì™¸êµ ê°ˆë“±ìœ¼ë¡œ ì£¼ìš” êµì—­êµ­ì´ í•µì‹¬ ì†Œì¬ ìˆ˜ì¶œì„ ê¸ˆì§€í–ˆìŠµë‹ˆë‹¤. ê³µì¥ ê°€ë™ì´ ë©ˆì¶”ê³  ìˆ˜ì¶œê¸¸ì´ ë§‰í ìœ„ê¸°ì…ë‹ˆë‹¤.", "options": [{"name": "êµ´ìš•ì  í˜‘ìƒ (ì‹¤ë¦¬)", "cost": 0, "effect": [10, 5, 5, -5], "detail": "ìƒëŒ€êµ­ì˜ ìš”êµ¬ë¥¼ ë“¤ì–´ì£¼ê³  ìˆ˜ì¶œê¸¸ì„ ì—½ë‹ˆë‹¤. ê²½ì œëŠ” ì‚´ë ¸ìœ¼ë‚˜, 'êµ­ê²©ì„ íŒ”ì•„ë¨¹ì—ˆë‹¤'ëŠ” êµ­ë¯¼ì  ë¹„ë‚œê³¼ ìì¡´ì‹¬ì˜ ìƒì²˜ëŠ” ê¹ŠìŠµë‹ˆë‹¤.", "reason": "ìë³¸ê°€+10 (ë§¤ì¶œíšŒë³µ), ë¹ˆê³¤ì¸µ-5 (ìì¡´ì‹¬)"}, {"name": "ê°•ê²½ ëŒ€ì‘ (ë§ë¶ˆ)", "cost": -10, "effect": [-15, -10, -10, -5], "detail": "ìì£¼ êµ­ê°€ì˜ ìì¡´ì‹¬ì€ ì§€í‚µë‹ˆë‹¤. í•˜ì§€ë§Œ ë¬´ì—­ ì „ìŸì´ ì¥ê¸°í™”ë˜ë©´ì„œ ë¬¼ê°€ê°€ í­ë“±í•˜ê³  ê¸°ì—… ì‹¤ì ì´ ì•…í™”ë˜ì–´ ì „ êµ­ë¯¼ì´ ê³ í†µë°›ìŠµë‹ˆë‹¤.", "reason": "ìë³¸ê°€-15 (ë§¤ì¶œê¸‰ê°), ì¤‘ì‚°ì¸µ-10 (ë¬¼ê°€)"}, {"name": "ì†Œì¬ êµ­ì‚°í™” R&D", "cost": -30, "effect": [-5, -5, 5, 0], "detail": "ì¥ê¸°ì ì¸ ê¸°ìˆ  ë…ë¦½ì„ ì„ ì–¸í•©ë‹ˆë‹¤. ë°©í–¥ì€ ì˜³ì§€ë§Œ, ë‹¹ì¥ì˜ ì„±ê³¼ê°€ ë‚˜ì˜¤ê¸°ê¹Œì§€ ë§‰ëŒ€í•œ ì˜ˆì‚° ì¶œí˜ˆê³¼ ê²½ê¸° ì¹¨ì²´ë¥¼ ê°ë‚´í•´ì•¼ í•©ë‹ˆë‹¤.", "reason": "ë…¸ë™ì+5 (ì¼ìë¦¬), êµ­ê³ -30 (ì§€ì¶œ)"}]},
        {"id": 5, "title": "ğŸ­ ê¸°í›„ ì¬ë‚œ", "img": "https://images.unsplash.com/photo-1579766922979-4d6cb600259d", "desc": "ìˆ¨ì„ ì‰´ ìˆ˜ ì—†ëŠ” ë¯¸ì„¸ë¨¼ì§€ì™€ ê¸°ë¡ì ì¸ í­ìš°ê°€ ë™ì‹œì— ë®ì³¤ìŠµë‹ˆë‹¤. ë°˜ì§€í•˜ ê±°ì£¼ë¯¼ì´ ê³ ë¦½ë˜ê³  ë†ì‘ë¬¼ ê°€ê²©ì´ í­ë“±í•©ë‹ˆë‹¤.", "options": [{"name": "íƒ„ì†Œì„¸ ë„ì…", "cost": +5, "effect": [-15, -5, 5, 10], "detail": "ê°•ë ¥í•œ ê·œì œë¡œ í™˜ê²½ì€ ê°œì„ ë˜ì—ˆê³  ì„¸ìˆ˜ë„ ëŠ˜ì—ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ë¹„ìš© ë¶€ë‹´ì´ ì»¤ì§„ ê¸°ì—…ë“¤ì´ ê³ ìš©ì„ ì¤„ì˜€ê³ , ë¬¼ê°€ ìƒìŠ¹ìœ¼ë¡œ ì¤‘ì‚°ì¸µì˜ ì‚¶ì´ íŒíŒí•´ì¡ŒìŠµë‹ˆë‹¤.", "reason": "ìë³¸ê°€-15 (ë¹„ìš©), ë¹ˆê³¤ì¸µ+10 (ì•ˆì „)"}, {"name": "ê²½ì œ ìš°ì„ ", "cost": 0, "effect": [15, 5, -10, -20], "detail": "ê³µì¥ì„ í’€ê°€ë™í•´ ê²½ì œ ì§€í‘œëŠ” ë°©ì–´í–ˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ê¸°í›„ ì¬ë‚œì˜ í”¼í•´ëŠ” ê³ ìŠ¤ë€íˆ ì·¨ì•½ê³„ì¸µì—ê²Œ ì§‘ì¤‘ë˜ì–´, ë¹ˆë¯¼ê°€ì˜ ì£¼ê±° í™˜ê²½ì´ íŒŒê´´ë˜ì—ˆìŠµë‹ˆë‹¤.", "reason": "ìë³¸ê°€+15 (ì´ìµ), ë¹ˆê³¤ì¸µ-20 (ì¹¨ìˆ˜í”¼í•´)"}, {"name": "í”¼í•´ ë³µêµ¬ ì§€ì›ê¸ˆ", "cost": -20, "effect": [-5, 0, 0, 10], "detail": "í”¼í•´ ì…ì€ êµ­ë¯¼ì—ê²Œ í˜„ê¸ˆì„ ì§€ê¸‰í•´ ì›ì„±ì„ ë‹¬ë¬ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ê·¼ë³¸ì ì¸ ì›ì¸ì€ í•´ê²°ë˜ì§€ ì•Šì•„ ë§¤ë…„ ê°™ì€ ì¬ë‚œì´ ë°˜ë³µë  ê²ƒì´ë©° ì¬ì •ë§Œ ì¶•ë‚©ë‹ˆë‹¤.", "reason": "ë¹ˆê³¤ì¸µ+10 (êµ¬ì œ), êµ­ê³ -20 (ì§€ì¶œ)"}]},
        {"id": 6, "title": "ğŸ“‰ í•©ê³„ì¶œì‚°ìœ¨ 0.5ëª…", "img": "https://images.unsplash.com/photo-1519689680058-324335c77eba", "desc": "êµ­ê°€ ì†Œë©¸ ìœ„ê¸°ë¡ ì´ ëŒ€ë‘ë˜ì—ˆìŠµë‹ˆë‹¤. êµ­ë¯¼ì—°ê¸ˆ ê³ ê°ˆ ê³µí¬ê°€ í™•ì‚°ë˜ë©° ì„¸ëŒ€ ê°„ ê°ˆë“±ì´ í­ë°œ ì§ì „ì…ë‹ˆë‹¤.", "options": [{"name": "í˜„ê¸ˆ ì§€ì› í™•ëŒ€", "cost": -30, "effect": [-5, 10, 5, -5], "detail": "ì•„ì´ ë‚³ëŠ” ê°€ì •ì— íŒŒê²©ì ì¸ ëˆì„ ì£¼ì–´ ì¤‘ì‚°ì¸µì€ í™˜í˜¸í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ ì¬ì› ë§ˆë ¨ì„ ìœ„í•´ ë…¸ì¸ ë³µì§€ ì˜ˆì‚°ì„ ê¹ìœ¼ë©´ì„œ ì·¨ì•½ê³„ì¸µ ë…¸ì¸ë“¤ì€ ìƒì¡´ ìœ„ê¸°ì…ë‹ˆë‹¤.", "reason": "ì¤‘ì‚°ì¸µ+10 (ì–‘ìœ¡ë¹„), ë¹ˆê³¤ì¸µ-5 (ë³µì§€ì¶•ì†Œ)"}, {"name": "ì´ë¯¼ì²­ ì„¤ë¦½", "cost": -5, "effect": [10, -10, -10, 5], "detail": "ë…¸ë™ë ¥ ë¶€ì¡±ì„ ì™¸êµ­ì¸ìœ¼ë¡œ ì±„ì›Œ ê¸°ì—…ì€ ì•ˆë„í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ ì¼ìë¦¬ ê²½ìŸì´ ì¹˜ì—´í•´ì§„ ë…¸ë™ìì™€ ë¬¸í™”ì  ì¶©ëŒì„ ìš°ë ¤í•˜ëŠ” ì¤‘ì‚°ì¸µì˜ ë°˜ë°œì´ ê±°ì…‰ë‹ˆë‹¤.", "reason": "ìë³¸ê°€+10 (ì¸ë ¥), ë…¸ë™ì-10 (ê²½ìŸ)"}, {"name": "ì—°ê¸ˆ ê°œí˜", "cost": +10, "effect": [-5, -15, -15, -5], "detail": "ì¬ì • ì‹œí•œí­íƒ„ì€ ì œê±°í–ˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ë‹¹ì¥ ì›”ê¸‰ì—ì„œ ë” ë§ì€ ëˆì´ ë–¼ì´ëŠ” ì§ì¥ì¸ë“¤ì˜ ë¶„ë…¸ê°€ íˆ¬í‘œ ì‹¬íŒìœ¼ë¡œ ì´ì–´ì§ˆ ê¸°ì„¸ì…ë‹ˆë‹¤.", "reason": "ì¤‘ì‚°ì¸µ-15 (ë³´í—˜ë£Œ), êµ­ê³ +10 (ì¬ì •)"}]}
    ],
    "ë§ê¸°": [
        {"id": 0, "title": "ğŸ“‰ ê¸€ë¡œë²Œ ë³µí•© ê¸ˆìœµ ìœ„ê¸°", "img": "https://images.unsplash.com/photo-1611974789855-9c2a0a7236a3", "desc": "ë¯¸êµ­ë°œ ê¸ˆë¦¬ ì¸ìƒê³¼ ì „ìŸ ë¦¬ìŠ¤í¬ë¡œ ì£¼ê°€ê°€ í­ë½í•˜ê³  í™˜ìœ¨ì´ 1,500ì›ì„ ëŒíŒŒí–ˆìŠµë‹ˆë‹¤. ê¸°ì—…ë“¤ì€ ì¤„ë„ì‚°ì„ ê²½ê³ í•˜ê³  ìˆìœ¼ë©°, ê°€ê³„ ë¶€ì±„ëŠ” ì‹œí•œí­íƒ„ì…ë‹ˆë‹¤.", "options": [{"name": "ë²•ì¸ì„¸ ì¸í•˜", "cost": -10, "effect": [15, 5, -10, -15], "detail": "ê¸°ì—…ì˜ ì„¸ê¸ˆì„ ê¹ì•„ì£¼ì–´ íˆ¬ìë¥¼ ìœ ë„í•©ë‹ˆë‹¤. ê¸°ì—… ìˆ¨í†µì€ íŠ¸ì´ì§€ë§Œ, ì„¸ìˆ˜ ë¶€ì¡±ìœ¼ë¡œ ë³µì§€ ì˜ˆì‚°ì´ ëŒ€í­ ì‚­ê°ë˜ì–´ ë¹ˆê³¤ì¸µì€ íƒ€ê²©ì„ ì…ìŠµë‹ˆë‹¤.", "reason": "ìë³¸ê°€+15 (ê°ì„¸), ë¹ˆê³¤ì¸µ-15 (ë³µì§€ì¶•ì†Œ)"}, {"name": "ì¬ë‚œì§€ì›ê¸ˆ ì‚´í¬", "cost": -30, "effect": [-15, 5, 10, 20], "detail": "êµ­ì±„ë¥¼ ë°œí–‰í•´ í˜„ê¸ˆì„ í’‰ë‹ˆë‹¤. ë‚´ìˆ˜ëŠ” ë°©ì–´í•˜ì§€ë§Œ, ë¬¼ê°€ ìƒìŠ¹ê³¼ êµ­ê°€ ë¶€ì±„ ê¸‰ì¦ìœ¼ë¡œ ê²½ì œ í€ë”ë©˜í„¸ì´ í›¼ì†ë©ë‹ˆë‹¤.", "reason": "ë¹ˆê³¤ì¸µ+20 (í˜„ê¸ˆ), ìë³¸ê°€-15 (ì¸í”Œë ˆ)"}, {"name": "ê³ ê¸ˆë¦¬ ê¸´ì¶•", "cost": +10, "effect": [5, -20, -10, -5], "detail": "í—ˆë¦¬ë ë¥¼ ì¡¸ë¼ë§¤ì–´ ë¬¼ê°€ë¥¼ ì¡ìŠµë‹ˆë‹¤. êµ­ê°€ ì‹ ìš©ì€ ì§€í‚¤ì§€ë§Œ, ì´ì í­íƒ„ì„ ë§ì€ 'ì˜ëŒ' ì¤‘ì‚°ì¸µê³¼ ìì˜ì—…ìë“¤ì´ ë¶•ê´´í•©ë‹ˆë‹¤.", "reason": "ìë³¸ê°€+5 (ìì‚°ë°©ì–´), ì¤‘ì‚°ì¸µ-20 (ì´ìí­íƒ„)"}]},
        {"id": 2, "title": "ğŸ“¢ ê´‘í™”ë¬¸ 100ë§Œ ì´›ë¶ˆ", "img": "https://images.unsplash.com/photo-1563986768609-322da13575f3", "desc": "ì •ë¶€ì˜ ë¶ˆí†µê³¼ ì‹¤ì •ì— ë¶„ë…¸í•œ ì‹œë¯¼ë“¤ì´ ê´‘í™”ë¬¸ì„ ê°€ë“ ë©”ì› ìŠµë‹ˆë‹¤. 'ëŒ€í†µë ¹ í‡´ì§„' êµ¬í˜¸ê°€ ë“±ì¥í–ˆìŠµë‹ˆë‹¤.", "options": [{"name": "ì¦ì„¸ ë° ë³µì§€", "cost": +20, "effect": [-25, -5, 10, 20], "detail": "ì‹œìœ„ëŒ€ì˜ ìš”êµ¬ë¥¼ ìˆ˜ìš©í•´ ì–‘ê·¹í™” í•´ì†Œ ëŒ€ì±…ì„ ë°œí‘œí•©ë‹ˆë‹¤. ì„œë¯¼ë“¤ì€ í™˜í˜¸í•˜ì§€ë§Œ, ì§•ë²Œì  ê³¼ì„¸ì— ë¶„ë…¸í•œ ìì‚°ê°€ë“¤ì€ ìë³¸ì„ í•´ì™¸ë¡œ ë¹¼ëŒë¦½ë‹ˆë‹¤.", "reason": "ë¹ˆê³¤ì¸µ+20 (í˜œíƒ), ìë³¸ê°€-25 (ì„¸ê¸ˆí­íƒ„)"}, {"name": "ê³µê¶Œë ¥ íˆ¬ì…", "cost": -5, "effect": [15, 5, -20, -15], "detail": "ê²½ì°°ë ¥ì„ ë™ì›í•´ ê°•ì œ í•´ì‚°ì‹œí‚µë‹ˆë‹¤. ë³´ìˆ˜ ì§€ì§€ì¸µì€ 'ë²•ì¹˜ í™•ë¦½'ì´ë¼ë©° ê²°ì§‘í•˜ì§€ë§Œ, ê³¼ì‰ ì§„ì•• ë…¼ë€ìœ¼ë¡œ ì¤‘ë„ì¸µê³¼ ì Šì€ ì„¸ëŒ€ëŠ” ë“±ì„ ëŒë¦½ë‹ˆë‹¤.", "reason": "ìë³¸ê°€+15 (ì§ˆì„œ), ë…¸ë™ì-20 (íƒ„ì••)"}, {"name": "ëŒ€êµ­ë¯¼ ì‚¬ê³¼", "cost": 0, "effect": [-10, 5, 5, 5], "detail": "ëŒ€í†µë ¹ì´ ê³ ê°œë¥¼ ìˆ™ì´ê³  ì°¸ëª¨ì§„ì„ ì „ì› êµì²´í•©ë‹ˆë‹¤. ë¶„ë…¸ëŠ” ê°€ë¼ì•‰ì§€ë§Œ, êµ­ì • ë™ë ¥ì´ ìƒì‹¤ë˜ì–´ ì•„ë¬´ê²ƒë„ í•  ìˆ˜ ì—†ëŠ” 'ì‹ë¬¼ ì •ë¶€'ê°€ ë©ë‹ˆë‹¤.", "reason": "ìë³¸ê°€-10 (ë¬´ëŠ¥), ì¤‘ì‚°ì¸µ+5 (ì†Œí†µ)"}]},
        {"id": 10, "title": "ğŸ’£ ë¶í•œ êµ­ì§€ì  ë„ë°œ", "img": "https://images.unsplash.com/photo-1554223249-1755a5b512c8", "desc": "íœ´ì „ì„  í¬ê²© ë„ë°œ. ê¸ˆìœµ ì‹œì¥ ì¶œë , ì•ˆë³´ ë¶ˆì•ˆ ìµœê³ ì¡°.", "options": [{"name": "ê°•ë ¥ ì‘ì§•", "cost": -20, "effect": [5, -5, -5, -5], "detail": "ë‹¨í˜¸í•œ ëŒ€ì²˜ë¡œ ë³´ìˆ˜ì¸µ ê²°ì§‘ê³¼ ì•ˆë³´ ì˜ì§€ë¥¼ ë³´ì—¬ì£¼ì—ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì „ìŸ ê³µí¬ë¡œ ì™¸êµ­ì¸ ìë³¸ì´ ë¹ ì ¸ë‚˜ê°€ê³  ì£¼ê°€ê°€ í­ë½í•´ ê²½ì œê°€ íœ˜ì²­ì…ë‹ˆë‹¤.", "reason": "ìë³¸ê°€+5 (ì•ˆë³´), ì¤‘ì‚°ì¸µ-5 (ì£¼ê°€í•˜ë½)"}, {"name": "ëŒ€í™” ì‹œë„", "cost": 0, "effect": [-15, 5, 5, 5], "detail": "í™•ì „ì€ ë§‰ì•˜ì§€ë§Œ, 'êµ´ì¢…ì ì¸ íƒœë„'ë¼ëŠ” ë¹„íŒì„ ë°›ìŠµë‹ˆë‹¤. ë³´ìˆ˜ ì§€ì§€ì¸µì´ ì´íƒˆí•˜ê³  êµ°ì˜ ì‚¬ê¸°ê°€ ì €í•˜ë˜ì—ˆìŠµë‹ˆë‹¤.", "reason": "ìë³¸ê°€-15 (ì‹¤ë§), ë¹ˆê³¤ì¸µ+5 (í‰í™”)"}, {"name": "êµ­ë°©ë¹„ ì¦ì•¡", "cost": -30, "effect": [-5, -10, -15, -5], "detail": "ìì£¼ êµ­ë°©ë ¥ì„ ê°•í™”í–ˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ë³µì§€ ì˜ˆì‚°ì„ êµ­ë°©ë¹„ë¡œ ëŒë ¤ì“°ëŠ” ë°”ëŒì— ë¯¼ìƒì´ ì–´ë ¤ì›Œì¡Œê³ , ì²­ë…„ë“¤ì˜ ì§•ë³‘ ë¶€ë‹´ë§Œ ì»¤ì¡ŒìŠµë‹ˆë‹¤.", "reason": "ë…¸ë™ì-15 (ë¯¼ìƒê³ ), êµ­ê³ -30 (ì§€ì¶œ)"}]},
        {"id": 8, "title": "ğŸ•µï¸ ê¶Œë ¥í˜• ë¹„ë¦¬ ê²Œì´íŠ¸", "img": "https://images.unsplash.com/photo-1589829545856-d10d557cf95f", "desc": "ì¸¡ê·¼ ë¹„ë¦¬ ë°œê°. 'ê³µì •'ì— ë¯¼ê°í•œ ì—¬ë¡  í­ë°œ.", "options": [{"name": "ì„±ì—­ ì—†ëŠ” ìˆ˜ì‚¬", "cost": 0, "effect": [-15, 10, 10, 0], "detail": "ì„±ì—­ ì—†ëŠ” ìˆ˜ì‚¬ë¡œ ì§€ì§€ìœ¨ì„ íšŒë³µí–ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì—¬ë‹¹ ë‚´ ê¸°ë“ê¶Œ ì„¸ë ¥ì´ ë°˜ë°œí•˜ë©° ëŒ€í†µë ¹ì˜ ë‹¹ë‚´ ì…ì§€ê°€ ì¢ì•„ì§€ê³  êµ­ì • ìš´ì˜ì´ ì™¸ë¡œì›Œì§‘ë‹ˆë‹¤.", "reason": "ì¤‘ì‚°ì¸µ+10 (ê³µì •), ìë³¸ê°€-15 (ë°˜ë°œ)"}, {"name": "ì •ì¹˜ íƒ„ì•• ì£¼ì¥", "cost": 0, "effect": [5, -20, -20, -5], "detail": "í•µì‹¬ ì§€ì§€ì¸µì€ ê²°ì§‘ì‹œì¼°ìœ¼ë‚˜, ì¤‘ë„ì¸µê³¼ ì²­ë…„ì¸µì€ 'ë‚´ë¡œë‚¨ë¶ˆ'ì´ë¼ë©° ë“±ì„ ëŒë ¸ìŠµë‹ˆë‹¤. ì •ê¶Œì˜ ë„ë•ì„±ì´ ë°”ë‹¥ì— ë–¨ì–´ì¡ŒìŠµë‹ˆë‹¤.", "reason": "ìë³¸ê°€+5 (ê²°ì§‘), ì¤‘ì‚°ì¸µ-20 (ì‹¤ë§)"}, {"name": "ì œë„ ê°œí˜ ì•½ì†", "cost": -10, "effect": [-5, 5, 5, 0], "detail": "ì œë„ ê°œì„ ì„ ì•½ì†í•˜ë©° ì‹œì„ ì„ ëŒë ¸ìŠµë‹ˆë‹¤. ê·¼ë³¸ì ì¸ í•´ê²°ì±…ì´ ë  ìˆ˜ ìˆìœ¼ë‚˜, ë‹¹ì¥ ì±…ì„ì ì²˜ë²Œì„ ì›í–ˆë˜ ì—¬ë¡ ì„ ì ì¬ìš°ê¸°ì—” ì—­ë¶€ì¡±ì…ë‹ˆë‹¤.", "reason": "ì¤‘ì‚°ì¸µ+5 (ê¸°ëŒ€), ìë³¸ê°€-5 (í”¼ë¡œ)"}]},
        {"id": 1, "title": "ğŸ¦  ì¹˜ëª…ì  ì‹ ì¢… ë°”ì´ëŸ¬ìŠ¤", "img": "https://images.unsplash.com/photo-1584036561566-baf8f5f1b144", "desc": "ì¹˜ì‚¬ìœ¨ ë†’ì€ ì „ì—¼ë³‘ì´ í™•ì‚° ì¤‘ì…ë‹ˆë‹¤. ì˜ë£Œ ë¶•ê´´ ì§ì „.", "options": [{"name": "êµ­ê°€ ë´‰ì‡„", "cost": -10, "effect": [-5, -10, -15, 5], "detail": "ê°•ë ¥í•œ ë´‰ì‡„ë¡œ í™•ì§„ìëŠ” ì¤„ì´ì§€ë§Œ, ìì˜ì—…ìì™€ ì¼ìš©ì§ ë…¸ë™ìì˜ ìƒê³„ê°€ ëŠê¹ë‹ˆë‹¤. ê²½ì œ í™œë™ ë§ˆë¹„ë¡œ ì¸í•œ í”¼í•´ê°€ ëˆˆë©ì´ì²˜ëŸ¼ ë¶ˆì–´ë‚©ë‹ˆë‹¤.", "reason": "ë¹ˆê³¤ì¸µ+5 (ìƒëª…ë³´í˜¸), ë…¸ë™ì-15 (ì‹¤ì§)"}, {"name": "ìœ„ë“œ ì½”ë¡œë‚˜", "cost": 0, "effect": [10, 5, 0, -25], "detail": "ê²½ì œê°€ ë©ˆì¶”ëŠ” ê²ƒì€ ë§‰ì•˜ìœ¼ë‚˜, ì˜ë£Œ ì‹œìŠ¤í…œì´ ë¶•ê´´ë©ë‹ˆë‹¤. ì¹˜ë£Œë¹„ê°€ ì—†ê±°ë‚˜ ë©´ì—­ë ¥ì´ ì•½í•œ ì·¨ì•½ê³„ì¸µ ì‚¬ë§ìê°€ ê¸‰ì¦í•˜ë©° 'ê°ìë„ìƒ' ì‚¬íšŒê°€ ë©ë‹ˆë‹¤.", "reason": "ìë³¸ê°€+10 (ë§¤ì¶œìœ ì§€), ë¹ˆê³¤ì¸µ-25 (ì‚¬ë§)"}, {"name": "ì¹˜ë£Œì œ ë¬´ìƒ", "cost": -40, "effect": [-5, 5, 5, 15], "detail": "ì²œë¬¸í•™ì ì¸ ì˜ˆì‚°ì„ ìŸì•„ë¶€ì–´ êµ­ë¯¼ ìƒëª…ì€ ì§€í‚µë‹ˆë‹¤. í•˜ì§€ë§Œ ê±´ê°•ë³´í—˜ ê¸°ê¸ˆì´ ê³ ê°ˆ ìœ„ê¸°ì— ì²˜í•˜ê³ , ì´ë¥¼ ë©”ê¾¸ê¸° ìœ„í•œ ì¦ì„¸ ë…¼ì˜ì— ìƒìœ„ì¸µì´ ë°˜ë°œí•©ë‹ˆë‹¤.", "reason": "ë¹ˆê³¤ì¸µ+15 (ë¬´ìƒì¹˜ë£Œ), êµ­ê³ -40 (ì¬ì •íƒ€ê²©)"}]}
    ]
}

# =============================================================================
# [4] ë©”ì¸ ë¡œì§
# =============================================================================

# ì´ˆê¸°í™”
if 'turn' not in st.session_state:
    st.session_state.turn = 1
    st.session_state.stats = {k: 50 for k in ARCHS}
    st.session_state.budget = 100
    st.session_state.game_over = False
    st.session_state.fail_msg = ""
    st.session_state.logs = []
    st.session_state.player_name = "ì„±ëª…ì„ ì…ë ¥í•˜ì„¸ìš”\n\nëª¨ë°”ì¼ì€ ì¢Œì¸¡ ìƒë‹¨ >> í´ë¦­"
    st.session_state.temp_name = ""
    st.session_state.current_crisis = random.choice(CRISES_POOL["ì´ˆê¸°"])

def restart():
    st.session_state.clear()
    st.rerun()

def next_turn(idx):
    opt = st.session_state.current_crisis['options'][idx]
    st.session_state.budget += opt['cost']
    for i, a in enumerate(ARCHS):
        st.session_state.stats[a] = max(0, min(100, st.session_state.stats[a] + opt['effect'][i]))
    
    st.session_state.logs.append(f"Turn {st.session_state.turn}: {opt['name']} ì„ íƒ")
    
    # ê²Œì„ ì˜¤ë²„ ì²´í¬
    if st.session_state.budget < 0:
        st.session_state.game_over = True
        st.session_state.fail_msg = "ğŸ’¸ êµ­ê°€ ë¶€ë„ ì„ ì–¸ (êµ­ê³  ê³ ê°ˆ)"
    elif any(v <= 0 for v in st.session_state.stats.values()):
        st.session_state.game_over = True
        
        # ìƒì„¸ ì‹¤íŒ¨ ì‚¬ìœ  ì„¤ì •
        if st.session_state.stats["ìë³¸ê°€"] <= 0:
            st.session_state.fail_msg = "ğŸ“‰ ìë³¸ê°€ë“¤ì˜ ëŒ€ê·œëª¨ ìë³¸ ì´íƒˆë¡œ ê²½ì œ ë¶•ê´´"
        elif st.session_state.stats["ì¤‘ì‚°ì¸µ"] <= 0:
            st.session_state.fail_msg = "ğŸ•¯ï¸ ì¤‘ì‚°ì¸µì˜ ì¡°ì„¸ ì €í•­ ë° ëŒ€í†µë ¹ íƒ„í•µ ì‹œìœ„"
        elif st.session_state.stats["ë…¸ë™ì"] <= 0:
            st.session_state.fail_msg = "âœŠ ë…¸ë™ì ì´íŒŒì—…ìœ¼ë¡œ êµ­ê°€ ê¸°ëŠ¥ ë§ˆë¹„"
        elif st.session_state.stats["ë¹ˆê³¤ì¸µ"] <= 0:
            st.session_state.fail_msg = "ğŸ”¥ ë¹ˆê³¤ì¸µì˜ ìƒì¡´ê¶Œ íˆ¬ìŸ ë° ëŒ€ê·œëª¨ í­ë™"
        else:
            st.session_state.fail_msg = "ğŸ”¥ ëŒ€ê·œëª¨ í­ë™ ë°œìƒ"

    elif st.session_state.turn >= 10:
        st.session_state.game_over = True
        st.session_state.fail_msg = "ğŸ‰ ì„ê¸° 5ë…„ ë§Œë£Œ"
    else:
        st.session_state.turn += 1
        # ì‹œê¸°ì— ë§ëŠ” ì´ë²¤íŠ¸ ì„ íƒ
        turn = st.session_state.turn
        if turn <= 3: pool = CRISES_POOL["ì´ˆê¸°"]
        elif turn <= 7: pool = CRISES_POOL["ì¤‘ê¸°"]
        else: pool = CRISES_POOL["ë§ê¸°"]
        
        st.session_state.current_crisis = random.choice(pool)

# UI ë Œë”ë§
render_bgm()
render_background()

st.markdown("""
    <style>
        .nameplate {
            background-color: #003478; border: 4px solid #c2a042;
            padding: 15px; border-radius: 10px; text-align: center;
            margin-bottom: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.5);
            display: flex; flex-direction: column; align-items: center;
        }
        .nameplate h3 { color: #c2a042 !important; margin: 0; font-weight: bold; font-size: 1.5rem; letter-spacing: 2px; }
        .nameplate h1 { color: white !important; margin: 5px 0 0 0; font-family: 'serif'; font-size: 2.8rem; font-weight: bold; text-shadow: 2px 2px 4px black; }
    </style>
""", unsafe_allow_html=True)

emblem_tag = get_emblem_tag()
st.markdown(f'''
<div class="nameplate">
    {emblem_tag}
    <h3>ëŒ€í•œë¯¼êµ­ ëŒ€í†µë ¹</h3>
    <h1>{st.session_state.player_name}</h1>
</div>
''', unsafe_allow_html=True)

st.title("ğŸ›ï¸ ëŒ€í†µë ¹ìœ¼ë¡œ ì‚´ì•„ë‚¨ê¸°")

# ì‚¬ì´ë“œë°”
with st.sidebar:
    st.header("1. ëŒ€í†µë ¹ ì·¨ì„")
    st.text_input("ì„±í•¨ ì…ë ¥ (ì—”í„°ì¹˜ë©´ ë°˜ì˜):", key="temp_name", on_change=update_name)
    
    if "load_ranking" in globals() and os.path.exists(FILE_RANKING):
        st.markdown("---")
        st.subheader("ğŸ† ëª…ì˜ˆì˜ ì „ë‹¹ (Top 5)")
        df_rank = load_ranking()
        if not df_rank.empty:
            st.dataframe(df_rank[["ì´ë¦„", "ì ìˆ˜", "ì¹­í˜¸"]].head(5), hide_index=True)

    st.markdown("---")
    st.header("â„¹ï¸ ê³„ì¸µ ê°€ì´ë“œ")
    with st.expander("â“ ê³„ì¸µë³„ í•µì‹¬ ì´ìµ ë³´ê¸°"):
        for k, v in ARCH_DESC.items():
            st.markdown(f"{v}")
            st.markdown("---")

# HUD
cols = st.columns(5)
cols[0].metric("êµ­ê³ ", f"{st.session_state.budget}ì¡°")
for i, a in enumerate(ARCHS):
    cols[i+1].metric(f"{a} ì§€ì§€ìœ¨", f"{st.session_state.stats[a]}%")

if not st.session_state.game_over:
    st.write(f"### ğŸ—“ï¸ ì„ê¸° {st.session_state.turn}ë…„ì°¨ / ì´ 10ë…„ (ë‚¨ì€ ì•ˆê±´: {11 - st.session_state.turn}ê°œ)")
    st.progress(min(1.0, (st.session_state.turn - 1) / 10))

st.markdown("---")

# ê²Œì„ í™”ë©´
if st.session_state.game_over:
    if "ì„±ê³µ" in st.session_state.fail_msg or "ë§Œë£Œ" in st.session_state.fail_msg:
        st.balloons()
        st.success(f"ğŸ† {st.session_state.fail_msg}")
        
        avg = sum(st.session_state.stats.values()) / 4
        budget = st.session_state.budget
        
        st.markdown(f"### ğŸ“Š ìµœì¢… ì„±ì : í‰ê·  ì§€ì§€ìœ¨ {avg:.1f}% / êµ­ê³  {budget}ì¡°")
        
        # [ë³µêµ¬] ìƒì„¸ ë‰´ìŠ¤ í—¤ë“œë¼ì¸ (ì ìˆ˜ë³„ ì¹­í˜¸)
        st.subheader("ğŸ“° [í˜¸ì™¸] ì„ê¸° ì¢…ë£Œ íŠ¹ë³„ ë³´ë„")
        
        score = int(avg + budget) # ì ìˆ˜ ê³„ì‚°ìš© ì„ì‹œ ë³€ìˆ˜
        if avg >= 60 and budget >= 60:
            st.success(f"### ğŸŒŸ ì—­ì‚¬ìƒ ê°€ì¥ ìœ„ëŒ€í•œ ì§€ë„ì, {st.session_state.player_name} ëŒ€í†µë ¹ í‡´ì„\n\nì§€ì§€ìœ¨ê³¼ ê²½ì œ ë‘ ë§ˆë¦¬ í† ë¼ë¥¼ ëª¨ë‘ ì¡ì€ 'ì „ì„¤ì˜ ì„±êµ°'ìœ¼ë¡œ ê¸°ë¡ë  ê²ƒ")
        elif avg >= 40:
            st.success(f"### âœ… ì„±ê³µì ì¸ êµ­ì • ìš´ì˜, ë°•ìˆ˜ì¹  ë•Œ ë– ë‚˜ëŠ” {st.session_state.player_name} ëŒ€í†µë ¹\n\nìˆ±í•œ ìœ„ê¸° ì†ì—ì„œë„ ëŒ€í•œë¯¼êµ­ì„ ì•ˆì •ì ìœ¼ë¡œ ì´ëŒì—ˆë‹¤ëŠ” í‰ê°€")
        elif budget < 20:
            st.warning(f"### ğŸ’¸ 'ì¸ê¸°ëŠ” ì–»ì—ˆìœ¼ë‚˜ ê³³ê°„ì€ ë¹„ì—ˆë‹¤'... í¬í“°ë¦¬ì¦˜ ë…¼ë€ ì† í‡´ì„\n\nì°¨ê¸° ì •ë¶€ì— ë§‰ëŒ€í•œ ì¬ì • ë¶€ë‹´ì„ ë„˜ê¸°ê²Œ ë˜ì–´... êµ­ê°€ ì‹ ìš©ë“±ê¸‰ ìš°ë ¤")
        elif avg < 25:
            st.error(f"### ğŸ’€ ì—­ëŒ€ ìµœì € ì§€ì§€ìœ¨... {st.session_state.player_name} ëŒ€í†µë ¹ì˜ ì“¸ì“¸í•œ ë’·ëª¨ìŠµ\n\nêµ­ë¡  ë¶„ì—´ê³¼ ì •ì±… ì‹¤íŒ¨ë¡œ ì–¼ë£©ì§„ 5ë…„... 'ì‹ë¬¼ ì •ë¶€' ì˜¤ëª… ë‚¨ê²¨")
        else:
            st.info(f"### âš–ï¸ 'ê³µê³¼ ê³¼' ëšœë ·... {st.session_state.player_name} ì •ë¶€ 5ë…„ì˜ ë§‰ì„ ë‚´ë¦¬ë‹¤\n\nìœ„ê¸° ê´€ë¦¬ ëŠ¥ë ¥ì€ ë‹ë³´ì˜€ìœ¼ë‚˜, ê³„ì¸µ ê°„ ê°ˆë“± í•´ì†ŒëŠ” ê³¼ì œë¡œ ë‚¨ì•„")

    else:
        st.error(f"ğŸ’€ GAME OVER: {st.session_state.fail_msg}")
        
        # [ë³µêµ¬] ìƒì„¸ ì‹¤íŒ¨ ì‚¬ìœ  ë©˜íŠ¸
        reason = ""
        if "ë¶€ë„" in st.session_state.fail_msg: 
            reason = "êµ­ê°€ ì¬ì •ì´ ë°”ë‹¥ë‚˜ IMF êµ¬ì œê¸ˆìœµì„ ì‹ ì²­í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. ê³µë¬´ì› ì›”ê¸‰ë§ˆì € ì²´ë¶ˆë˜ëŠ” ì´ˆìœ ì˜ ì‚¬íƒœê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."
        elif "ìë³¸ê°€" in st.session_state.fail_msg: 
            reason = "ì™¸êµ­ì¸ íˆ¬ììê°€ ëª¨ë‘ ë– ë‚˜ê³  ì£¼ì‹ ì‹œì¥ì´ ë¶•ê´´ë˜ì—ˆìŠµë‹ˆë‹¤. ê¸°ì—…ë“¤ì€ ì¤„ë„ì‚°í•˜ê³  ì‹¤ì—…ìê°€ ê±°ë¦¬ë¥¼ ë©”ìš°ê³  ìˆìŠµë‹ˆë‹¤."
        elif "ì¤‘ì‚°ì¸µ" in st.session_state.fail_msg: 
            reason = "ê´‘í™”ë¬¸ì— 100ë§Œ ëª…ì´ ëª¨ì—¬ ëŒ€í†µë ¹ íƒ„í•µì„ ì™¸ì¹˜ê³  ìˆìŠµë‹ˆë‹¤. 'ì„¸ê¸ˆë§Œ ê±·ì–´ê°€ê³  í•´ì¤€ ê²Œ ë­ëƒ'ëŠ” ë¶„ë…¸ê°€ í­ë°œí–ˆìŠµë‹ˆë‹¤."
        elif "ë…¸ë™ì" in st.session_state.fail_msg: 
            reason = "ì „êµ­ì ì¸ ì´íŒŒì—…ìœ¼ë¡œ ì „ê¸°, ìˆ˜ë„, êµí†µì´ ëª¨ë‘ ëŠê²¼ìŠµë‹ˆë‹¤. ë¬¼ë¥˜ê°€ ë§ˆë¹„ë˜ì–´ ë§ˆíŠ¸ì— ìƒí•„í’ˆì´ ë™ë‚¬ìŠµë‹ˆë‹¤."
        elif "ë¹ˆê³¤ì¸µ" in st.session_state.fail_msg: 
            reason = "ìƒì¡´ê¶Œì„ ìš”êµ¬í•˜ëŠ” ê²©ë ¬í•œ ì‹œìœ„ê°€ í­ë™ìœ¼ë¡œ ë²ˆì¡ŒìŠµë‹ˆë‹¤. ì•½íƒˆê³¼ ë°©í™”ë¡œ ë„ì‹œ ê¸°ëŠ¥ì´ ë§ˆë¹„ë˜ì—ˆìŠµë‹ˆë‹¤."
        
        st.markdown(f"**{reason}**")

    # ì •ì¹˜ì¸ ìœ í˜• ë¶„ì„ (ê²Œì„ì˜¤ë²„ ì—¬ë¶€ ìƒê´€ì—†ì´ í‘œì‹œ)
    my_type = get_politician_type(st.session_state.stats)
    p_data = POLITICIAN_TYPES[my_type]
    
    st.markdown("---")
    st.subheader(f"ğŸ§© ë‹¹ì‹ ì˜ ì •ì¹˜ ì„±í–¥: [{my_type}]")
    st.write(f"**\"{p_data['title']}\"**")
    st.info(p_data['desc'])
    
    st.write("#### ğŸ‘¥ ë‹¹ì‹ ê³¼ ë¹„ìŠ·í•œ í˜„ì‹¤ ì •ì¹˜ì¸")
    pc1, pc2 = st.columns(2)
    
    # [ìˆ˜ì •] ë¡œì»¬ ì´ë¯¸ì§€ í™•ì¸ í›„ ì¶œë ¥
    with pc1:
        m1 = p_data['models'][0]
        img1 = get_model_image(m1['id'], m1['img'])
        st.image(img1, caption=m1['name'])
        
    with pc2:
        m2 = p_data['models'][1]
        img2 = get_model_image(m2['id'], m2['img'])
        st.image(img2, caption=m2['name'])
        
    st.markdown("---")

    # ì§€ì§€ì¸µ ë¶„ì„
    sorted_stats = sorted(st.session_state.stats.items(), key=lambda x: x[1])
    best = sorted_stats[-1]
    worst = sorted_stats[0]
    
    col_a, col_b = st.columns(2)
    col_a.metric("â¤ï¸ í•µì‹¬ ì§€ì§€ì¸µ", f"{best[0]} ({best[1]}%)")
    col_b.metric("ğŸ’” ìµœëŒ€ ë¹„í† ì¸µ", f"{worst[0]} ({worst[1]}%)")

    # [ë³µêµ¬] ë­í‚¹ ì €ì¥ ë¡œì§ (ì ìˆ˜ ê³„ì‚° ë° ì¹­í˜¸ ë¶€ì—¬)
    if "score_saved" not in st.session_state:
        # ì ìˆ˜ ê³„ì‚°: (ì§€ì§€ìœ¨ í‰ê·  * 2) + (êµ­ê³ )
        final_score = int((sum(st.session_state.stats.values()) / 4) * 2 + st.session_state.budget)
        
        # ì¹­í˜¸ ê²°ì •
        if "ì„±ê³µ" not in st.session_state.fail_msg and "ë§Œë£Œ" not in st.session_state.fail_msg:
            final_title = "ë¶ˆëª…ì˜ˆ í‡´ì§„"
            final_score = int(final_score / 2) # ì‹¤íŒ¨ ì‹œ ì ìˆ˜ ë°˜í† ë§‰
        else:
            if final_score >= 180: final_title = "ì „ì„¤ì˜ ì„±êµ°"
            elif final_score >= 160: final_title = "ì„±ê³µí•œ ì§€ë„ì"
            elif final_score >= 140: final_title = "ë…¸ë ¨í•œ ì •ì¹˜ê°€"
            else: final_title = "ì•„ì‰¬ìš´ ëŒ€í†µë ¹"
        
        if "save_ranking" in globals():
            save_ranking(st.session_state.player_name, final_score, final_title)
        st.session_state.score_saved = True

    # ëª…ì˜ˆì˜ ì „ë‹¹ Top 10 (ê²°ê³¼ì°½)
    if "load_ranking" in globals() and os.path.exists(FILE_RANKING):
        st.markdown("---")
        st.subheader("ğŸ† ëª…ì˜ˆì˜ ì „ë‹¹ (Top 10)")
        df_rank = load_ranking()
        if not df_rank.empty:
            st.dataframe(df_rank.head(10), hide_index=True)

    if st.button("ğŸ”„ ë‹¤ì‹œ í•˜ê¸° (ì¬ë‹¹ì„  ë„ì „)"):
        restart()
        
    with st.expander("ğŸ“œ ì§€ë‚œ ê¸°ë¡ ë³´ê¸°"):
        for log in st.session_state.logs:
            st.write(log)

else:
    c = st.session_state.current_crisis
    st.error(f"ğŸš¨ [ì†ë³´] {c['title']}")
    
    img_url = get_crisis_image(c.get('id', 99), c.get('img'))
    if img_url:
        st.image(img_url, use_container_width=True)
        
    st.write(f"### {c['desc']}")
    
    col1, col2, col3 = st.columns(3)
    for i, opt in enumerate(c['options']):
        with [col1, col2, col3][i]:
            st.info(f"{opt['name']}")
            st.caption(f"ğŸ“ {opt['detail']}")
            sign = "+" if opt['cost'] > 0 else ""
            st.write(f"ğŸ’° **êµ­ê³  {sign}{opt['cost']}ì¡°**")
            if st.button(f"ìŠ¹ì¸ ({i+1})", key=f"btn_{st.session_state.turn}_{i}"):
                next_turn(i)
                st.rerun()
